<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="Giuseppe Della Penna"><link rel="shortcut icon" href=https://gdellapenna.github.io/img/favicon.ico type=image/x-icon><title>Giuseppe Della Penna :: The UPMurphi Planner
</title><link href=https://gdellapenna.github.io/css/bootstrap.min.css rel=stylesheet><link rel=stylesheet href=https://gdellapenna.github.io/css/bootstrap-icons.min.css><link rel=stylesheet href=/css/site.min.css><script src=https://gdellapenna.github.io/script/jquery.min.js></script></head><body style=position:relative data-bs-spy=scroll data-bs-target=#sidenav id=top><a id=tocontent href=#body class=d-sm-none><i class="bi bi-chevron-double-down"></i>Skip to content</a><div><nav class="text-light navbar navbar-light navbar-expand navbar-dark justify-content-center" style=background-color:#025078><div class="d-none d-lg-flex flex-fill"><ul class="navbar-nav ms-auto"><li class=nav-item><a class='link-light nav-link' href=https://gdellapenna.github.io/><span class='bi bi-house' title></span>
Home</a></li><li class='nav-item dropdown'><a class="link-light nav-link dropdown-toggle" role=button href=# data-bs-toggle=dropdown aria-expanded=false><span class='bi bi-info-circle' title></span>About</a><ul class="dropdown-menu dropdown-menu-end"><li><a class=dropdown-item href=https://gdellapenna.github.io/info/curriculum/><span class='bi bi-person-lines-fill' title></span>
Curriculum</a></li><li><a class=dropdown-item href=https://gdellapenna.github.io/info/contact/><span class='bi bi-person-vcard' title></span>
Contact info</a></li></ul></li><li class='nav-item dropdown'><a class="link-light nav-link dropdown-toggle" role=button href=# data-bs-toggle=dropdown aria-expanded=false><span class='bi bi-bank' title></span>Research</a><ul class="dropdown-menu dropdown-menu-end"><li><a class=dropdown-item href=https://gdellapenna.github.io/research/bibliography/><span class='bi bi-journal-text' title></span>
Publications</a></li><li><a class=dropdown-item href=https://gdellapenna.github.io/research/topics/><span class='bi bi-lightbulb' title></span>
Topics</a></li><li><a class=dropdown-item href=https://gdellapenna.github.io/research/upmurphi/>UPMurphi</a></li></ul></li><li class='nav-item dropdown'><a class="link-light nav-link dropdown-toggle" role=button href=# data-bs-toggle=dropdown aria-expanded=false><span class='bi bi-mortarboard' title></span>Teaching</a><ul class="dropdown-menu dropdown-menu-end"><li><a class=dropdown-item href=https://laboratoriobasididati-univaq.github.io/><span class='bi bi-easel' title></span>
Laboratorio Basi di Dati</a></li><li><a class=dropdown-item href=https://sviluppowebavanzato-univaq.github.io/><span class='bi bi-easel' title></span>
Sviluppo Web Avanzato</a></li><li><a class=dropdown-item href=https://webengineering-univaq.github.io/><span class='bi bi-easel' title></span>
Web Engineering</a></li><li><a class=dropdown-item href=https://gdellapenna.github.io/teaching/oldcourses/><span class='bi bi-easel-fill' title></span>
Old courses</a></li><li><a class=dropdown-item href=https://gdellapenna.github.io/teaching/theses/><span class='bi bi-book' title></span>
Theses</a></li></ul></li></ul></div><div class="d-flex align-items-center justify-content-stretch d-lg-none d-block" style=background-color:#025078><form class="d-flex align-items-center justify-content-stretch accessible-menu"><div class="text-light text-nowrap me-1">Page</div><select class=form-select><option value=https://gdellapenna.github.io/>Home</option><option disabled value>About</option><option value=https://gdellapenna.github.io/info/curriculum/>>Curriculum</option><option value=https://gdellapenna.github.io/info/contact/>>Contact info</option><option disabled value>Research</option><option value=https://gdellapenna.github.io/research/bibliography/>>Publications</option><option value=https://gdellapenna.github.io/research/topics/>>Topics</option><option value=https://gdellapenna.github.io/research/upmurphi/>>UPMurphi</option><option disabled value>Teaching</option><option value=https://laboratoriobasididati-univaq.github.io/>>Laboratorio Basi di Dati</option><option value=https://sviluppowebavanzato-univaq.github.io/>>Sviluppo Web Avanzato</option><option value=https://webengineering-univaq.github.io/>>Web Engineering</option><option value=https://gdellapenna.github.io/teaching/oldcourses/>>Old courses</option><option value=https://gdellapenna.github.io/teaching/theses/>>Theses</option></select></form></div></nav></div><header id=page-header><div id=page-header-maintitle>Giuseppe Della Penna<h1 id=page-header-pagetitle>The UPMurphi Planner</h1></div></header><main id=center class=container-fluid><div class="row my-2 text-justify"><div class="col-12 text-justify" id=body><p>The <em><strong>U</strong>niversal <strong>P</strong>lanner Murphi</em> supports planning and universal planning for linear and nonlinear continuous <strong>PDDL+</strong> models with <strong>processes</strong> and <strong>events</strong>. UPMurphi also supports Timed Initial Literals and Timed Initial Fluents.</p><p>UPMurphi is based on the <em>Discretise and Validate</em> approach and it has been designed to automatically interface with the VAL plan validator.</p><p><strong>Warning: this project is no longer maintained. Unfortunately, the Murphi core, which UPMurphi builds on, is rather old and has not been updated, so maintaining UPMurphi would require us a complete rewriting of the base code, which is currently impossible. If you still want to try it, refer to the troubleshoot.txt for the correct versions of the libraries and tools that were used in our last successful compilations. Thanks for your interest in UPMurphi, we hope to come back soon with a new, updated tool.</strong></p><h2 id=quick-start>Quick Start</h2><p>To quickly begin using UPMurphi, follow these steps.</p><ul><li>First of all, <a href=install>download the latest UPMurphi distribution package</a>.</li><li>By default, UPMurphi uses a 32-bit compilation. However, it has been designed to support compilation onto 64-bit architectures, although it has not been fully tested yet. To succesfully compile UPMurphi, make sure you have the required libraries: on Ubuntu you can simply issue the following command: <code>sudo apt-get install build-essential flex bison libc6-dev-i386 gcc-multilib g++-multilib</code>. Similar packages need to be installed in other Linux distributions as well as in Cygwin under Windows.</li><li>Enter the &ldquo;src&rdquo; directory, call &ldquo;make&rdquo; and cross your fingers. If everything is ok, the upmurphi compiler (upmc) and the PDDL-to-Murphi compiler (pddl2upm) are now in the &ldquo;bin&rdquo; directory.</li><li>To compile a PDDL domain/problem to an UPMurphi planner, invoke the UPMurphi compiler (upmc): <code>upmc &lt;domain.pddl> &lt;problem.pddl></code>. This will call several tools (including the g++ compiler) and generate the executable planner, called <code>problem_planner(.exe)</code>, as well as other support and intermediate files.</li><li>Once the executable planner has been generated, you can run it to start the planning process. By default, the planner will allocate 1Gb of memory, search for a feasible plan and write it to the file problem_plan.pddl.</li><li>If you want to use the VAL validator to automatically validate the generated plans, <a href="http://www.inf.kcl.ac.uk/research/groups/PLANNING/index.php?option=com_content&view=article&id=70&Itemid=77#Compilation">download and install it separately</a>, then edit the Makefile in the &ldquo;src/UPMurphi&rdquo; folder and write the complete pathname of the &ldquo;validate&rdquo; binary as the value of the VAL_PATHNAME constant.</li></ul><p>For more information about how to download, install and use UPMurphi, follow the links below:</p><ul><li><a href=install>Downloading & installing UPMurphi</a></li><li><a href=usage>Creating & executing planners for PDDL domains and problems</a></li></ul><h2 id=current-limitations-of-upmurphi>Current Limitations of UPMurphi</h2><p>UPMurphi requires the PDDL+ domain <strong>to be typed</strong> for being processed. The only metric currently supported by UPMUrphi is <strong>:minimize total-time</strong>.</p><p>Note that the current version does not use any heuristic search algorithm. Due to the blind search finding a plan may take long, so be patient ;)</p><h2 id=usage-examples>Usage Examples</h2><h3 id=discretisation-of-the-pddl-model>Discretisation of the PDDL+ Model</h3><p>Assuming you are in the ex/generator directory:</p><ul><li><em>From a PDDL+ domain and problem with user specific discretisation settings (timestep 0.5, mantissa digits: 5, exponent digits: 2):</em><br><code>../../bin/upmc tank_domain.pddl tank_problem.pddl --custom 0.5 5 2</code></li><li><em>From a PDDL+ domain and problem with default discretisation settings</em><br><code>../../bin/upmc planetary_lander.pddl planetary_lander_problem.pddl</code></li></ul><h3 id=planning-and-validating>Planning and Validating</h3><ul><li><em>Default settings (search for feasible solution, output PDDL+ plans, 1Gb RAM) with PDDL+ verbose mode (includes comments with values for the state variable):</em><br><code>./tank_domain_planner -format:pddlvv</code></li><li><em>Specific Settings (2Gb RAM, plan duration limited to 20 time units):</em><br><code>./planetary_lander_planner -m 2000 -tl 20</code></li></ul><h2 id=papers-on-upmurphi>Papers on UPMurphi</h2><p>For an updated list of related publications see <a href=../bibliography>the papers page</a>.</p><h2 id=changelog>Changelog</h2><h3 id=20r1-upmurphi-is-born-2142010>2.0R1: &ldquo;UPMurphi is born&rdquo; (21/4/2010)</h3><h3 id=20r2-a-real-fix-652010>2.0R2: &ldquo;A Real Fix&rdquo; (6/5/2010)</h3><ul><li>FIX: Fixed a memory leak in mu_real.cpp (&ldquo;name&rdquo; property now deleted in the class descructor).</li></ul><h3 id=20r3-millions-of-rules-362010>2.0R3: &ldquo;Millions of Rules&rdquo; (3/6/2010)</h3><ul><li>UPD: The type used to point and index UPMurphi rules is now parametric (declared in mu_prolog.hpp for the planner and mu.hpp for the compiler, of course the two declarations must be identical). It is currently set to unsigned long, while previously it was an unsigned int. This allows us to handle even the billions of rules generated by the house-lifting case study. Warning: this also causes a big increase of memory requirements during the transition graph generation phase.</li><li>NEW: Exploration progress reports now show the exploration speed, expressed both in rules per second and states per second.</li></ul><h3 id=20r4-remember-your-errors-962010>2.0R4: &ldquo;Remember your Errors&rdquo; (9/6/2010)</h3><ul><li>NEW: This update makes UPMurphi not to include in the final graph the transitions leading to an error state, i.e., which violate an invariant. Indeed, with the previous &ldquo;Murphi-like&rdquo; logic, error states were not expanded, but transitions leading to them were still included in the final system dynamics. To exploit errors during postprocessing, error transitions are now written in a separate file, with &ldquo;.errors&rdquo; extension. However, so far this file is never read or used.</li><li>NEW: Added new text dump method for ENUMs.</li><li>NEW: Exploration progress reports now show the number of error states encontered so far.</li></ul><h3 id=20r5-better-control-1662010>2.0R5: &ldquo;Better Control&rdquo; (16/6/2010)</h3><ul><li>FIX: Fixed and optimized the code for the controller generation (format:raw). In particular, now the plan generation phase is skipped if the required output is a binary, textual or compressed controller.</li><li>FIX: Fixed a couple of errors (hoping that there are no others!) in the UPMurphi compiler which limited the extension of the rule indexes to unsigned long.</li></ul><h3 id=20r6-errors-squared-2162010>2.0R6 &ldquo;Errors squared&rdquo; (21/6/2010)</h3><ul><li>FIX: Memory leak found and fixed. Memory increased at each goal or error reached, since in this case the corresponding temporary state was not removed from memory nor queued. An almost invisible effect, unless invariants were massively used.</li><li>UPD: Modification of the output format: now also in the output modes text, raw (binary controller) and obdd (compressed controller) only rules with PDDL class action or durative_start are written. In this way, rules used internally by the model to simulate other characteristics of the system can be classified as events and not appear in the controller.</li></ul><h3 id=20r7-longer-fseeks-2862010>2.0R7 &ldquo;Longer (f)seeks&rdquo; (28/6/2010)</h3><ul><li>NEW: Introduced in OutputManager class the static function lfseek, called in place of fseeks (in particular on the reachables file) that may require offsets larger than an unsigned long.</li><li>NEW: Added the number of controller actions to the properties file (.properties), eliminating the need to manually recalculate it though a division on the value returned by ftell (which could lead to an overflow!).</li><li>UPD: Reorganization of the code: part of the classes in upm_system have been moved to the new files upm_storage and upm_graph.</li><li>DEL: CUDD distribution was removed from UPMurphi. To use the OBDD compression (experimental) is now necessary to download and install CUDD manually in the cudd/ directory inside the UPMurphi root.</li></ul><h3 id=20r8-disk-graph--malicious-sort-772010>2.0R8 &ldquo;Disk Graph&rdquo; + &ldquo;Malicious Sort&rdquo; (7/7/2010)</h3><ul><li>FIX: Critical bug! The hash-campacted hash table insertion algorithm of the original Murphi is actually smarter than it seems. Indeed, while inserting new elements (state signatures), it keeps ordered (in descending order w.r.t. signature values) the collision lists associated with each ht slot. This is done by a very subtle code inside the &ldquo;search for an empty slot&rdquo; loop. In the previous versions of UPMurphi, particular state schemes, hash function seeds and a crowded table could lead to an incorrect state-signature/state-index association, since the indexes weren&rsquo;t reordered with the corresponding signatures. In other words, UPMurphi could overlap two distinct states, ending in a different transition graph. This would often not affect the plan synthesis, but its optimality (and the number of controlled states). After three days of in-depth debugging of the ht logic, the problem was solved.</li><li>NEW: The StateGraph class, which represents the system transition graph, has been split in two implementations: a memory-image implementation, nearly identical to the previous one, and an indexed-disk-image, which (as the name suggests) stores (as efficently as possible) the graph on disk. As a consequence, UPMurphi now can load and analyze HUGE transition graphs. The better is that you haven&rsquo;t to choose which implementation to use: UPMurphi will estimate the memory needed by the transition graph during the state space exploration, and select the most suitable representation.</li><li>UPD: Timestamps in reports are now written in a more human-friendly hh:mm:ss format :)</li><li>NEW: Added the number of errors to the properties file (.properties).</li><li>UPD: Rules in rulesets are now correctly written in PDDL as parametric actions.</li></ul><h3 id=20r9-csv-controller-17112010>2.0R9 &ldquo;CSV controller&rdquo; (17/11/2010)</h3><ul><li>NEW: Added the CSV output format (switch -format:csv), which writes the controller actions in a user-friendly but still machine-readable fashion using comma separated values. The controller state-action pairs are written one per line, and each line contains the state variables and their values (in the form name: value), separated by a semicolon and followed by the rule (action) name. Note that only the state variables marked with a pddlname are printed.</li></ul><h3 id=20r10-calculated-attributes-12022013>2.0R10 &ldquo;Calculated attributes&rdquo; (12/02/2013)</h3><ul><li>FIX: Critical bug! Rule weights and durations were recalculated when needed (e.g., during optimal paths calculation and plan generation), but in this way state-dependant values (i.e., calculated through an expression on the current state variables) had incorrect values. The solution is to calculate the rule weight and duration during the state space expansion and write them to the .transitions file together with the corresponding transition, so they don&rsquo;t need to be recalculated anymore. However, this requires more memory and disk space. Therefore, the two new &ndash;varweight and &ndash;varduration switches have been added to the UPMurphi compiler (upmc) command line. If specified, they declare that the model uses state-dependant expressions to evaluate the rule weight and duration, respectively. In this way, the not-state-dependant values continue to be recalculated &ldquo;on the fly&rdquo;, saving memory. Warning: if you use state-dependant expressions but do not specify the corresponding switch on the upmc command line, the planning results will be incorrect.</li></ul><h3 id=30-integration-13042015>3.0 &ldquo;Integration&rdquo; (13/04/2015)</h3><ul><li>NEW: integrated PDDL parsing. Now upmc can process a pre-built model file (.m) as well as a pair of (domain,problem) pddl files.</li><li>NEW: upmc options &ndash;prompt and &ndash;custom X Y Z passed to the PDDL parser</li><li>NEW: automatic compilation of executable planner with g++ (can be skipped with &ndash;noexec)</li><li>NEW: debug mode planners (step-execution of rules) with the &ndash;debug option</li><li>FIX: correct pddl output (syntax of timestamps and durations)</li><li>CHG: now planner output is always written to a file (if not specified, the problem name is used to derive the output filename), and can be optionally displayed also on stdout with the -print option</li><li>CHG: default memory for planner is now 1Gb</li><li>CHG: bit compression and hash compaction are now defaults in upmc</li><li>NEW: &ldquo;domain&rdquo; and &ldquo;problem&rdquo; keywords in model files to link the model to the source pddl files</li><li>NEW: automatic plan validation using VAL (-val)</li><li>NEW: makefile defines to configure planner compilation and plan validation switches</li><li>NEW: automatic pathname discovery for include and bin directories (UPMURPHI_HOME should not be needed any more in default installations)</li><li>NEW: closed hash table full no longer breaks the computation if at least one goal state has been reached</li><li>NEW: &ldquo;message&rdquo; keyword in model file to include messages in the planner output</li><li>NEW: Planning task summary at the beginning of the planner&rsquo;s output</li><li>NEW: real constant T in the model file is now automatically recognised as the model time quantum</li><li>NEW: real variable TIME in the model file, if present, is used to measure the plan length</li><li>NEW: if plan length is available, the new option -tl allows to limit the length of the plans</li><li>FIX: 64 bit filesystem g++ compiler option added to the planner compilation switches</li><li>NEW: compiler warnings are suppressed by default (use &ndash;warnings to show them)</li><li>CHG: experimental OBDD extension removed from the release</li></ul></div></div></main><footer id=footer class="d-flex w-100 justify-content-between align-items-start"><div>(c) <a href=https://gdellapenna.github.io/info/contact>Giuseppe Della Penna</a> | <a href=https://gdellapenna.github.io/info/credits>credits</a></div><div>Valid <a href=http://validator.w3.org title="validate markup">HTML5</a> and <a href=http://jigsaw.w3.org/css-validator title="validate CSS">CSS3</a></div></footer><a id=totop href=#top><i class="bi bi-chevron-double-up"></i></a>
<script src=https://gdellapenna.github.io/script/bootstrap.bundle.js></script><script src=https://gdellapenna.github.io/script/personal.js></script></body></html>